<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.model.DbMapper">

	<select id="movieTime" resultType="MovieTimeDTO">
			select * from movietime 
			order by m_index desc 
	</select>
	
	<select id="movieInfo" resultType="MovieInfoDTO">
			select * from movieinfo
			order by m_index desc 
	</select>
	
	<select id="movieInfoBefore" resultType="MovieInfoDTO">
			select * from movieinfo
			where sysdate() > mdate
			order by m_index asc 
	</select>
	
	<select id="movieInfoAfter" resultType="MovieInfoDTO">
			select * from movieinfo
			where mdate > sysdate()
			order by m_index asc 
	</select>
	
	<select id="movieDetail" resultType="MovieInfoDTO">
	  select * from movieinfo where m_index =#{m_index}
	 </select>
	
	
	
	
	<select id="findMovie" resultType="MovieInfoDTO" parameterType="java.lang.String">
			select * from movieinfo where movietitle = #{movietitle}
	</select>
	
	<select id="findMovieTime" resultType="MovieTimeDTO" parameterType="java.lang.String">
			select * from movietime where movietitle = #{movietitle}
	</select>
	
	<insert id="insertMovieTime" parameterType="MovieTimeDTO" >
		insert into movietime (movietitle,sectorno,starttime,endtime,reg_date) 
		values 
		(#{movietitle},#{sectorno},#{starttime},#{endtime},#{reg_date})
	</insert>
	
	
	<select id="findactor" resultType="ActorDTO" parameterType="java.lang.String">
		select * from actor where actorname = #{actorname}
	</select>
	<!-- 이름이 같으면서 ,생일 다른 동명이인 가져오게 한다.   -->
	
	<!-- 영화정보 등록 시1 ... 영화기본정보 -->
	<insert id="movieinfoinsert"  parameterType="MovieInfoDTO">
		insert into movieinfo (movietitle, mdir, mdate, mplaytime, mplot)
		values
		(#{movietitle}, #{mdir}, #{mdate}, #{mplaytime}, #{mplot} )
		
	</insert>
	<!-- 영화정보 등록 시2 ... 배우들 -->
	<insert id="actormovieinsert" parameterType="ActorDTO">
		insert into actor (actorid, movietitle )
		values
		(#{actorid}, #{movietitle}    )
	</insert>
	<!-- 영화정보 등록 시3 ... 카테고리 -->
	<insert id="catemovieinsert" parameterType="CateDTO">
		insert into cate (movietitle, cate) 
		values
		( #{movietitle}  ,#{cate})		
	</insert>
	
	<insert id="movieimgin" parameterType="MimgDTO">
	<!-- String 배열은 어렵.. -->
		insert into movieimg (movietitle, imgname)
		values
		(#{movietitle}, #{imgname})
		
	</insert>
	
	<!--==========영화정보 불러올 때1  from  movieinfo ====================-->
	 <select id="pullmovieinfo">
	  select * from movieinfo where movietitle =#{movietitle}
	 </select>
	
	<!--영화정보 불러올 때2  배우들-->
	
	 <select id="pullactor" resultType="ActorDTO">
	 	 select * from actor where movietitle =#{movietitle}
	 </select>	
	
	<!--영화정보 불러올 때3  -->
	
	 <select id="pullcate" resultType="CateDTO">
	  select * from cate where movietitle =#{movietitle}
	 </select>			
			
	<!--영화정보 불러올 때4 > 영화 이미지   -->
	
	 <select id="pullimg" resultType="MimgDTO">
	  select * from movieimg where movietitle =#{movietitle}
	 </select>	
	 
	 
	 
	 <!--movieInfoList 열 떄 .
	 	<if test="newpw != null and newpw != ''">
			PW=#{newpw},
		</if>	 
	  -->
	  
	  <select id="movieinfolist" resultType="MovieinfoDTO" parameterType="HashMap">	  
	  select * from movieinfo 
	  
	  order by m_index desc
	  
	   limit #{pdto.start},#{pdto.limit}
	  
	  </select>
	 
	 
	
	
	<insert id="cateinsert"></insert>
	
	
	
	
	
	
</mapper>